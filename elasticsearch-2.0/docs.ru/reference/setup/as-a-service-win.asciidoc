:backslash: \

[[setup-service-win]]
== Запуск в режиме службы в Windows

Пользователи Windows могут сконфигурировать Elasticsearch для запуска в режиме службы в фоновом
режиме или автоматического запуска при старте без какого-либо вмешательства пользователя.
Это может быть достигнуно с помощью скрипта `service.bat`, который находится в каталоге `bin/`
и который позволяет установить, удалить, управлять или сконфигурировать службу, а также потенциально
запустить и остановить службу с помощью командной строки.

["source","sh",subs="attributes,callouts"]
--------------------------------------------------
c:\elasticsearch-{version}{backslash}bin>service

Usage: service.bat install|remove|start|stop|manager [SERVICE_ID]
--------------------------------------------------

Данный скрипт требует один параметр (команду для запуска) за которой следует один необязательный
идентификатор службы (полезно, если устанавливается несколько служб Elasticsearch).

Доступными командами являются:

[horizontal]
`install`:: Устанавливает Elasticsearch как службу

`remove`:: Удаляет установленную службу Elasticsearch (и останавливает службу если она запущена)

`start`:: Запускает службу Elasticsearch (если она установлена)

`stop`:: Останавливает службу Elasticsearch (если она запущена)

`manager`:: Запускает графический интерфейс для управления установленной службой

Обратите внимание, что опции конфигурации окружения, доступные во время установки, копируются
и будут затем использоваться при работе службы. Это означает, что любые изменения, сделанные
в них после установки, не будут работать до тех пор, пока служба не будет переустановлена.

Служба будет установлена 32-bit(x86) или 64-bit(x64) в зависимости от доступной архитектуры
JDK/JRE (определяется через `JAVA_HOME`). Данная информация доступна во время установки:

["source","sh",subs="attributes,callouts"]
--------------------------------------------------
c:\elasticsearch-{version}\bin>service install
Installing service      :  "elasticsearch-service-x64"
Using JAVA_HOME (64-bit):  "c:\jvm\jdk1.8"
The service 'elasticsearch-service-x64' has been installed.
--------------------------------------------------

NOTE: Хотя JRE может быть использована для службы Elasticsearch, поскольку JRE использует
клиента VM (в отличие от сервера JVM, который предлагает лучшую производительность для долго
работающих приложений), его использование не рекомендуется, о чём будет выдано предупреждение.


[float]
=== Специальные настройки службы

Для того, чтобы настроить службу специальным образом, существует два способа:

Графический интерфейс управления:: доступен через команду `manager`, и предлагает для установленной
службы управление состоянием, типом запуска, JVM, настройку запуска и останова и некоторые другие вещи.
Просто вызовите `service.bat` с командной строки с опцией manager, что приведёт к открытию окна управления:

image::images/service-manager-win.png["Windows Service Manager GUI",align="center"]

Кастомная правка `service.bat`:: по сути `service.bat` использует для установки служб тот же механизм,
что проект http://commons.apache.org/proper/commons-daemon/[Apache Commons Daemon]. Для специальной
настройки под пользователя, из под которого запускается служба, можно соответствующим образом изменить
установочные параметры. Обратите внимание, что для того, чтобы новые настройки начали работать,
необходима переустановка службы.

NOTE: Также существует поддерживаемый сообществом установщик MSI доступный по адресу: https://github.com/salyh/elasticsearch-msi-installer (от Хендрика Сэйли (Hendrik Saly)).
